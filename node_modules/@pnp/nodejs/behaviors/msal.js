import { ConfidentialClientApplication } from "@azure/msal-node";
import { objectDefinedNotNull } from "@pnp/core";
export function MSAL(config, scopes = ["https://graph.microsoft.com/.default"]) {
    const confidentialClient = new ConfidentialClientApplication(config);
    return (instance) => {
        instance.on.auth(async (url, init) => {
            const token = await confidentialClient.acquireTokenByClientCredential({ scopes });
            if (objectDefinedNotNull(token)) {
                init.headers = { ...init.headers, Authorization: `${token.tokenType} ${token.accessToken}` };
            }
            return [url, init];
        });
        return instance;
    };
}
//# sourceMappingURL=msal.js.map